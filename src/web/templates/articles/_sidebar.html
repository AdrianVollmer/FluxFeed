<!-- Article Filters Sidebar -->
<aside class="w-56 flex-shrink-0 hidden lg:block">
    <div class="sticky top-8 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 space-y-6">

        <!-- View Mode -->
        <div>
            <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">View</h3>
            <div class="flex gap-1 p-1 bg-gray-100 dark:bg-gray-700 rounded-lg">
                <button id="view-cards-sidebar" onclick="setView('cards')"
                    class="flex-1 px-3 py-1.5 rounded text-sm font-medium transition flex items-center justify-center gap-1.5">
                    {% include "icons/grid.html" %}
                    Cards
                </button>
                <button id="view-compact-sidebar" onclick="setView('compact')"
                    class="flex-1 px-3 py-1.5 rounded text-sm font-medium transition flex items-center justify-center gap-1.5">
                    {% include "icons/list.html" %}
                    List
                </button>
            </div>
        </div>

        <!-- Show Filter -->
        <div>
            <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">Show</h3>
            <div class="space-y-1">
                <a href="/articles?is_read=false"
                   class="flex items-center justify-between px-3 py-2 rounded-lg text-sm transition
                          {% if active_filter == "unread" %}bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium{% else %}hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300{% endif %}">
                    <span class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full {% if active_filter == "unread" %}bg-blue-500{% else %}bg-gray-300 dark:bg-gray-600{% endif %}"></span>
                        Unread
                    </span>
                    <span class="text-xs {% if active_filter == "unread" %}text-blue-600 dark:text-blue-400{% else %}text-gray-500{% endif %}">{{ article_counts.unread }}</span>
                </a>
                <a href="/articles?show=all"
                   class="flex items-center justify-between px-3 py-2 rounded-lg text-sm transition
                          {% if active_filter == "all" %}bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium{% else %}hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300{% endif %}">
                    <span class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full {% if active_filter == "all" %}bg-blue-500{% else %}bg-gray-300 dark:bg-gray-600{% endif %}"></span>
                        All
                    </span>
                    <span class="text-xs {% if active_filter == "all" %}text-blue-600 dark:text-blue-400{% else %}text-gray-500{% endif %}">{{ article_counts.total }}</span>
                </a>
                <a href="/articles?is_read=true"
                   class="flex items-center justify-between px-3 py-2 rounded-lg text-sm transition
                          {% if active_filter == "read" %}bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium{% else %}hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300{% endif %}">
                    <span class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full {% if active_filter == "read" %}bg-blue-500{% else %}bg-gray-300 dark:bg-gray-600{% endif %}"></span>
                        Read
                    </span>
                    <span class="text-xs {% if active_filter == "read" %}text-blue-600 dark:text-blue-400{% else %}text-gray-500{% endif %}">{{ article_counts.read }}</span>
                </a>
                <a href="/articles?is_starred=true"
                   class="flex items-center justify-between px-3 py-2 rounded-lg text-sm transition
                          {% if active_filter == "starred" %}bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium{% else %}hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300{% endif %}">
                    <span class="flex items-center gap-2">
                        {% include "icons/star-inline.html" %}
                        Starred
                    </span>
                    <span class="text-xs {% if active_filter == "starred" %}text-blue-600 dark:text-blue-400{% else %}text-gray-500{% endif %}">{{ article_counts.starred }}</span>
                </a>
            </div>
        </div>

        <!-- Feed Filter -->
        {% if feeds.len() > 0 %}
        <div>
            <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">From</h3>
            <button
                hx-get="/articles/filter-modal?feed_ids={{ filter_feed_ids|join(",") }}&group_ids={{ filter_group_ids|join(",") }}{% if filter_read.is_some() %}&is_read={{ filter_read.unwrap() }}{% endif %}{% if filter_starred.is_some() %}&is_starred={{ filter_starred.unwrap() }}{% endif %}"
                hx-target="#feed-filter-modal"
                hx-swap="innerHTML"
                class="w-full flex items-center justify-between px-3 py-2 rounded-lg text-sm transition
                       {% if !filter_feed_ids.is_empty() || !filter_group_ids.is_empty() %}bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300{% else %}bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300{% endif %}">
                <span class="flex items-center gap-2">
                    {% include "icons/folder.html" %}
                    {% if filter_feed_ids.is_empty() && filter_group_ids.is_empty() %}
                        All Feeds
                    {% else %}
                        {{ filter_feed_ids.len() + filter_group_ids.len() }} selected
                    {% endif %}
                </span>
                {% include "icons/chevron-right.html" %}
            </button>
            {% if !filter_feed_ids.is_empty() || !filter_group_ids.is_empty() %}
            <a href="/articles{% if filter_read.is_some() %}?is_read={{ filter_read.unwrap() }}{% endif %}{% if filter_starred.is_some() %}{% if filter_read.is_some() %}&{% else %}?{% endif %}is_starred={{ filter_starred.unwrap() }}{% endif %}"
               class="mt-2 text-xs text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1">
                {% include "icons/close-sm.html" %}
                Clear feed filter
            </a>
            {% endif %}
        </div>
        {% endif %}

        <!-- Actions -->
        {% if article_counts.unread > 0 %}
        <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
            <button
                hx-post="/articles/mark-all-read{% if !filter_feed_ids.is_empty() %}?feed_ids={{ filter_feed_ids|join(",") }}{% endif %}"
                hx-confirm="Are you sure you want to mark all {% if !filter_feed_ids.is_empty() || !filter_group_ids.is_empty() %}filtered {% endif %}articles as read?"
                class="w-full px-3 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition flex items-center justify-center gap-2">
                {% include "icons/check-double.html" %}
                Mark All as Read
            </button>
        </div>
        {% endif %}
    </div>
</aside>
